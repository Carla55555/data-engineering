2025-12-29 11:59:04,015 | INFO | Running step: ingest 
2025-12-29 11:59:04,140 | INFO | Folder already exists: data\raw
Folder already exists: logs
SUCCESS: Raw datasets are ready.

2025-12-29 11:59:04,140 | WARNING | 2025-12-29 11:59:04,133 | INFO | Logging initialized
2025-12-29 11:59:04,133 | INFO | Starting ingestion validation (local raw data mode)...
2025-12-29 11:59:04,133 | INFO | Found file: data\raw\dataset.csv (517599 bytes)
2025-12-29 11:59:04,133 | INFO | Columns validated for dataset.csv
2025-12-29 11:59:04,133 | INFO | Found file: data\raw\mxmh_survey_results.csv (172563 bytes)
2025-12-29 11:59:04,135 | INFO | Columns validated for mxmh_survey_results.csv
2025-12-29 11:59:04,135 | INFO | Ingestion validation finished successfully

2025-12-29 11:59:04,162 | INFO | Step finished successfully: ingest
2025-12-29 11:59:04,164 | INFO | Running step: transform 
2025-12-29 11:59:04,900 | INFO | Folder created: data\processed
Folder already exists: logs
SUCCESS: processed tables created in data/processed/

2025-12-29 11:59:04,900 | WARNING | 2025-12-29 11:59:04,787 | INFO | Logging initialized for transform step
2025-12-29 11:59:04,787 | INFO | Starting transform step (clean + aggregate)...
2025-12-29 11:59:04,803 | INFO | Loaded music raw: (1000, 28), survey raw: (736, 33)
2025-12-29 11:59:04,819 | INFO | Music cleaned: 1000 rows, 27 cols
2025-12-29 11:59:04,819 | INFO | Range check Age: allowed [0,120] | NaNs 1 -> 1
2025-12-29 11:59:04,819 | INFO | Range check Hours per day: allowed [0,24] | NaNs 0 -> 0
2025-12-29 11:59:04,819 | INFO | Range check Anxiety: allowed [0,10] | NaNs 0 -> 0
2025-12-29 11:59:04,819 | INFO | Range check Depression: allowed [0,10] | NaNs 0 -> 0
2025-12-29 11:59:04,843 | INFO | Range check Insomnia: allowed [0,10] | NaNs 0 -> 0
2025-12-29 11:59:04,845 | INFO | Range check OCD: allowed [0,10] | NaNs 0 -> 0
2025-12-29 11:59:04,845 | INFO | Survey cleaned: 736 rows, 34 cols
2025-12-29 11:59:04,845 | INFO | Music aggregated by genre: 10 genres
2025-12-29 11:59:04,847 | INFO | Mental health aggregated by genre: 16 genres
2025-12-29 11:59:04,850 | INFO | Saved: data\processed\music_features_by_genre.csv
2025-12-29 11:59:04,850 | INFO | Saved: data\processed\mental_health_by_genre.csv
2025-12-29 11:59:04,850 | INFO | Transform step finished successfully

2025-12-29 11:59:04,900 | INFO | Step finished successfully: transform
2025-12-29 11:59:04,900 | INFO | Running step: load_dw 
2025-12-29 11:59:05,743 | INFO | Folder already exists: data\warehouse
Folder already exists: logs
SUCCESS: Data Warehouse created/updated: data\warehouse\music_dw.sqlite

2025-12-29 11:59:05,743 | WARNING | 2025-12-29 11:59:05,622 | INFO | Logging initialized for warehouse step
2025-12-29 11:59:05,622 | INFO | Starting warehouse load (SQLite)...
2025-12-29 11:59:05,622 | INFO | Loaded processed tables: music=(10, 27), mental=(16, 7)
2025-12-29 11:59:05,660 | INFO | Schema created / validated
2025-12-29 11:59:05,666 | INFO | Upserted genres into dim_genre: 19 candidates
2025-12-29 11:59:05,666 | INFO | dim_genre size: 19
2025-12-29 11:59:05,666 | INFO | Cleared fact tables (fact_music_features, fact_mental_health)
2025-12-29 11:59:05,666 | INFO | Loaded music facts: 260 rows
2025-12-29 11:59:05,674 | INFO | Loaded mental health facts: 96 rows
2025-12-29 11:59:05,674 | INFO | Warehouse load finished successfully, DB at: data\warehouse\music_dw.sqlite

2025-12-29 11:59:05,743 | INFO | Step finished successfully: load_dw
